<!DOCTYPE html>
<html>

<head>
    <meta charset=utf-8 />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Thanks for Sharing</title>

    <link rel="stylesheet" type="text/css" href="index.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans">
    <link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.orangeindigo.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="icon" href="../images/verycoolmathgamestitle.png" type="image/x-icon">
    
    <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script>
    <script defer="" src="https://code.getmdl.io/1.1.3/material.min.js"></script>
    <script defer="" src="/__/firebase/6.2.4/firebase-app.js"></script>
    <script defer="" src="/__/firebase/6.2.4/firebase-auth.js"></script>
    <script defer="" src="/__/firebase/6.2.4/firebase-database.js"></script>
    <script defer="" src="/__/firebase/6.2.4/firebase-messaging.js"></script>
    <script defer="" src="/__/firebase/6.2.4/firebase-storage.js"></script>
    <script defer="" src="/__/firebase/init.js"></script>
    <script src="https://www.gstatic.com/firebasejs/6.2.4/firebase-firestore.js"></script>

  <script>

    const firebase = require("firebase");
    require("firebase/firestore");

    function getUserDetails() {

      firebase.initializeApp({
      apiKey: "AIzaSyCxRTkWjoToUoNsM8Rm6zPwiJBG_JCB4fo",
      authDomain: "verycoolthanksforsharing.firebaseapp.com",
      databaseURL: "https://verycoolthanksforsharing.firebaseio.com",
      projectId: "verycoolthanksforsharing",
      storageBucket: "verycoolthanksforsharing.appspot.com",
      messagingSenderId: "78626384450",
      appId: "1:78626384450:web:5c1a5470485502ab"
      });

      var user = firebase.auth().currentUser;
      var name, uid;

      if (user != null) {
        name = user.displayName;
        uid = user.uid;
      };

      var db = firebase.firestore();
      var website_chat = db.collection("website_chat");
      var displayNames = db.collection("displayNames");

      firebase.auth().onAuthStateChanged(function (user) {
        if (user) {
          toggleSelection(false);
          toggleChatroom(true);
        } else {
          toggleChatroom(false);
          toggleSelection(true);
        }
      });
    }

    function toggleChatroom(on) {
        var el = document.getElementsByClassName('chatroom');

        el.style['display'] = on ? 'block' : 'none';
    };

    function toggleSelection(on) {
        var el = document.getElementsByClassName('selectroom');

        el.style['display'] = on ? 'block' : 'none';
    };

    function sendMessage(chatroom, text) {
      db.collection(chatroom).add({
        displayName: name,
        text: text,
        time: db.ServerValue.TIMESTAMP,
        uid: uid,
      })
        .then(function (docRef) {
          console.log("Message sent with docid: ", docRef.id);
        })
        .catch(function (error) {
          console.error("Error sharing a very cool message, thanks for sharing though!", error);
        });
    };

    getRealtimeUpdates = function() {
      // WHAT I"M DOING RIGHT NOW
      // GOAL: MAKE THE UPDATING SYSTEM SO YOU CAN SEE OTHERS" MESSAGES
      docRef.onSnapshort(function(doc){
        var para = document.createElement("p");
        var node = document.createTextNode("This is a new.");
        para.appendChild(node);
        var element = document.getElementById("chathistory");
        element.appendChild(para);
      })
    }
    getRealtimeUpdates();

    window.onload = function () {
      getUserDetails();
    };

  </script>

</head>

<body OnLoad="document.myform.txt.focus()" style="font-family: sans-serif">


  <!--Actual Chatroom Interface-->
  <div class="chatroom">
    <div class="chathistory">
      <p>Chat:</p>
    </div>
    
    <div class="textBox">
      <form>

      </form>
    </div>
  </div>
  <!--Actual Chatroom Interface-->



  <!--Chatroom Selection Interface-->
  <div class="selectroom">
    <form>

    </form>
  </div>
  <!--Chatroom Selection Interface-->


</body>
</html>